name: Updating a GitHub key - REPOB_V0_TOKEN0

on:
  push:
    branches:
      - main
      
jobs:
  job0_update_REPOB_V0_TOKEN0:
    runs-on: ubuntu-latest

    permissions: write-all

    steps:
      - name: Assign a new value to the secret
        env:
          GH_TOKEN: ${{ secrets.REPOB_V0_TOKEN0 || github.token }}
          # The `github.token` is not equivalent to a GitHub Actions secret token. The `github.token` is a special token provided by GitHub that allows actions to authenticate and interact with the GitHub API on behalf of the workflow run. It is automatically generated and available for use within GitHub Actions workflows.
          # However, if GH_TOKEN: ${{ secrets.REPOB_V0_TOKEN0 }} OR GH_TOKEN: ${{ github.token }}, it will throw an error.
        run: |
          repoOwner=$(echo "${{ github.repository }}" | cut -d '/' -f 1);
          repoOwnerEmail="j622amilah@gmail.com";
          repoName=$(echo "${{ github.repository }}" | cut -d '/' -f 2);
          
          git config --global user.email ${repoOwnerEmail};
          git config --global user.name ${repoOwner};
          git pull origin main;
          git checkout main;
          
          git branch -m main;
          git branch --set-upstream-to origin/main;
          
          gh secret set REPOB_V0_TOKEN0 --app actions --body ${{ secrets.REPOB_V0_TOKEN0 }} --repos $repoOwner/$repoName
